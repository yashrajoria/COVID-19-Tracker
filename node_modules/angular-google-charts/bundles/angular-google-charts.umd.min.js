!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("@angular/core"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("angular-google-charts",["exports","rxjs","@angular/core","rxjs/operators"],e):e((t=t||self)["angular-google-charts"]={},t.rxjs,t.ng.core,t.rxjs.operators)}(this,(function(t,e,r,o){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var n=function(){return(n=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function a(t,e,r,o){var n,a=arguments.length,i=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(i=(a<3?n(i):a>3?n(e,r,i):n(e,r))||i);return a>3&&i&&Object.defineProperty(e,r,i),i}function i(t,e){return function(r,o){e(r,o,t)}}function s(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function p(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,a=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}function h(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t}var l,u,d=function(){function t(t){this.editor=t,this.doneSubject=new e.Subject,this.addEventListeners()}return t.prototype.afterClosed=function(){return this.doneSubject.asObservable()},t.prototype.cancel=function(){this.editor.closeDialog()},t.prototype.addEventListeners=function(){var t=this;google.visualization.events.addOneTimeListener(this.editor,"ok",(function(){google.visualization.events.removeAllListeners(t.editor);var e=t.editor.getChartWrapper();t.doneSubject.next(e),t.doneSubject.complete()})),google.visualization.events.addOneTimeListener(this.editor,"cancel",(function(){google.visualization.events.removeAllListeners(t.editor),t.doneSubject.next(null),t.doneSubject.complete()}))},t}(),y=new r.InjectionToken("GOOGLE_CHARTS_CONFIG"),g={mapsApiKey:"",version:"current",safeMode:!1},f=function(){function t(t,r,o){this.zone=t,this.localeId=r,this.config=o,this.scriptSource="https://www.gstatic.com/charts/loader.js",this.scriptLoadSubject=new e.Subject,this.config=n(n({},g),o||{})}return t.prototype.isGoogleChartsAvailable=function(){return"undefined"!=typeof google&&void 0!==google.charts},t.prototype.loadChartPackages=function(){for(var t=this,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return this.loadGoogleCharts().pipe(o.switchMap((function(){return new e.Observable((function(e){var o={packages:r,language:t.localeId,mapsApiKey:t.config.mapsApiKey,safeMode:t.config.safeMode};google.charts.load(t.config.version,o),google.charts.setOnLoadCallback((function(){t.zone.run((function(){e.next(),e.complete()}))}))}))})))},t.prototype.loadGoogleCharts=function(){var t=this;if(this.isGoogleChartsAvailable())return e.of(null);if(!this.isLoadingGoogleCharts()){var r=this.createGoogleChartsScript();r.onload=function(){t.zone.run((function(){t.scriptLoadSubject.next(),t.scriptLoadSubject.complete()}))},r.onerror=function(){t.zone.run((function(){console.error("Failed to load the google charts script!"),t.scriptLoadSubject.error(new Error("Failed to load the google charts script!"))}))}}return this.scriptLoadSubject.asObservable()},t.prototype.isLoadingGoogleCharts=function(){return null!=this.getGoogleChartsScript()},t.prototype.getGoogleChartsScript=function(){var t=this;return Array.from(document.getElementsByTagName("script")).find((function(e){return e.src===t.scriptSource}))},t.prototype.createGoogleChartsScript=function(){var t=document.createElement("script");return t.type="text/javascript",t.src=this.scriptSource,t.async=!0,document.getElementsByTagName("head")[0].appendChild(t),t},t.ctorParameters=function(){return[{type:r.NgZone},{type:String,decorators:[{type:r.Inject,args:[r.LOCALE_ID]}]},{type:void 0,decorators:[{type:r.Inject,args:[y]},{type:r.Optional}]}]},t.ɵprov=r["ɵɵdefineInjectable"]({factory:function(){return new t(r["ɵɵinject"](r.NgZone),r["ɵɵinject"](r.LOCALE_ID),r["ɵɵinject"](y,8))},token:t,providedIn:"root"}),t=a([r.Injectable({providedIn:"root"}),i(1,r.Inject(r.LOCALE_ID)),i(2,r.Inject(y)),i(2,r.Optional()),s("design:paramtypes",[r.NgZone,String,Object])],t)}(),b=function(){function t(t){this.scriptLoaderService=t,this.initializedSubject=new e.Subject}return Object.defineProperty(t.prototype,"initialized$",{get:function(){return this.initializedSubject.asObservable()},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.scriptLoaderService.loadChartPackages("charteditor").subscribe((function(){t.editor=new google.visualization.ChartEditor,t.initializedSubject.next(t.editor),t.initializedSubject.complete()}))},t.prototype.editChart=function(t,e){var r=new d(this.editor);return this.editor.openDialog(t.chartWrapper,e||{}),r.afterClosed().subscribe((function(e){e&&(t.chartWrapper=e)})),r},t.ctorParameters=function(){return[{type:f}]},t=a([r.Component({selector:"chart-editor",template:"<ng-content></ng-content>",host:{class:"chart-editor"},changeDetection:r.ChangeDetectionStrategy.OnPush}),s("design:paramtypes",[f])],t)}();(l=t.ChartType||(t.ChartType={})).AnnotationChart="AnnotationChart",l.AreaChart="AreaChart",l.Bar="Bar",l.BarChart="BarChart",l.BubbleChart="BubbleChart",l.Calendar="Calendar",l.CandlestickChart="CandlestickChart",l.ColumnChart="ColumnChart",l.ComboChart="ComboChart",l.PieChart="PieChart",l.Gantt="Gantt",l.Gauge="Gauge",l.GeoChart="GeoChart",l.Histogram="Histogram",l.Line="Line",l.LineChart="LineChart",l.Map="Map",l.OrgChart="OrgChart",l.Sankey="Sankey",l.Scatter="Scatter",l.ScatterChart="ScatterChart",l.SteppedAreaChart="SteppedAreaChart",l.Table="Table",l.Timeline="Timeline",l.TreeMap="TreeMap",l.WordTree="wordtree",(u=t.FilterType||(t.FilterType={})).Category="CategoryFilter",u.ChartRange="ChartRangeFilter",u.DateRange="DateRangeFilter",u.NumberRange="NumberRangeFilter",u.String="StringFilter";var v,m=function(){function t(t){this.loaderService=t,this.error=new r.EventEmitter,this.ready=new r.EventEmitter,this.stateChange=new r.EventEmitter,this.id="_"+Math.random().toString(36).substr(2,9),this.wrapperReadySubject=new e.ReplaySubject(1),this.initialized=!1}return Object.defineProperty(t.prototype,"wrapperReady$",{get:function(){return this.wrapperReadySubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"controlWrapper",{get:function(){return this._controlWrapper},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.loaderService.loadChartPackages("controls").subscribe((function(){t.createControlWrapper(),t.initialized=!0}))},t.prototype.ngOnChanges=function(t){this.initialized&&(t.type&&this._controlWrapper.setControlType(this.type),t.options&&this._controlWrapper.setOptions(this.options),t.state&&this._controlWrapper.setState(this.state))},t.prototype.createControlWrapper=function(){this._controlWrapper=new google.visualization.ControlWrapper({containerId:this.id,controlType:this.type,state:this.state,options:this.options}),this.addEventListeners(),this.wrapperReadySubject.next(this._controlWrapper)},t.prototype.addEventListeners=function(){var t=this;google.visualization.events.removeAllListeners(this._controlWrapper),google.visualization.events.addListener(this._controlWrapper,"ready",(function(e){return t.ready.emit(e)})),google.visualization.events.addListener(this._controlWrapper,"error",(function(e){return t.error.emit(e)})),google.visualization.events.addListener(this._controlWrapper,"statechange",(function(e){return t.stateChange.emit(e)}))},t.ctorParameters=function(){return[{type:f}]},a([r.Input(),s("design:type",Object)],t.prototype,"for",void 0),a([r.Input(),s("design:type",String)],t.prototype,"type",void 0),a([r.Input(),s("design:type",Object)],t.prototype,"options",void 0),a([r.Input(),s("design:type",Object)],t.prototype,"state",void 0),a([r.Output(),s("design:type",Object)],t.prototype,"error",void 0),a([r.Output(),s("design:type",Object)],t.prototype,"ready",void 0),a([r.Output(),s("design:type",Object)],t.prototype,"stateChange",void 0),a([r.HostBinding("id"),s("design:type",Object)],t.prototype,"id",void 0),t=a([r.Component({selector:"control-wrapper",template:"",host:{class:"control-wrapper"},exportAs:"controlWrapper",changeDetection:r.ChangeDetectionStrategy.OnPush}),s("design:paramtypes",[f])],t)}(),C=function(){function t(t,e){this.element=t,this.loaderService=e,this.ready=new r.EventEmitter,this.error=new r.EventEmitter,this.initialized=!1}return t.prototype.ngOnInit=function(){var t=this;this.loaderService.loadChartPackages("controls").subscribe((function(){t.createDataTable(),t.createDashboard(),t.initialized=!0}))},t.prototype.ngOnChanges=function(t){this.initialized&&(t.data||t.columns)&&(this.createDataTable(),this.dashboard.draw(this.dataTable))},t.prototype.createDashboard=function(){var t=this,r=this.controlWrappers.map((function(t){return t.wrapperReady$})),o=this.controlWrappers.map((function(t){return t.for})).map((function(t){return Array.isArray(t)?e.combineLatest(t.map((function(t){return t.wrapperReady$}))):t.wrapperReady$}));e.combineLatest(h(r,o)).subscribe((function(){t.dashboard=new google.visualization.Dashboard(t.element.nativeElement),t.initializeBindings(),t.dashboard.draw(t.dataTable)}))},t.prototype.initializeBindings=function(){var t=this;this.controlWrappers.forEach((function(e){if(Array.isArray(e.for)){var r=e.for.map((function(t){return t.chartWrapper}));t.dashboard.bind(e.controlWrapper,r)}else t.dashboard.bind(e.controlWrapper,e.for.chartWrapper)}))},t.prototype.createDataTable=function(){if(null!=this.data){var t=!0;null!=this.columns&&(t=!1),this.dataTable=google.visualization.arrayToDataTable(this.getDataAsTable(),t)}},t.prototype.getDataAsTable=function(){return this.columns?h([this.columns],this.data):this.data},t.ctorParameters=function(){return[{type:r.ElementRef},{type:f}]},a([r.Input(),s("design:type",Array)],t.prototype,"data",void 0),a([r.Input(),s("design:type",Array)],t.prototype,"columns",void 0),a([r.Output(),s("design:type",Object)],t.prototype,"ready",void 0),a([r.Output(),s("design:type",Object)],t.prototype,"error",void 0),a([r.ContentChildren(m),s("design:type",r.QueryList)],t.prototype,"controlWrappers",void 0),t=a([r.Component({selector:"dashboard",template:"<ng-content></ng-content>",changeDetection:r.ChangeDetectionStrategy.OnPush,exportAs:"dashboard",host:{class:"dashboard"}}),s("design:paramtypes",[r.ElementRef,f])],t)}(),w=function(){function t(t,o,n){this.element=t,this.scriptLoaderService=o,this.dashboard=n,this.options={},this.dynamicResize=!1,this.ready=new r.EventEmitter,this.error=new r.EventEmitter,this.select=new r.EventEmitter,this.mouseover=new r.EventEmitter,this.mouseleave=new r.EventEmitter,this.wrapperReadySubject=new e.ReplaySubject(1),this.initialized=!1}return Object.defineProperty(t.prototype,"chart",{get:function(){return this.wrapper?this.wrapper.getChart():null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wrapperReady$",{get:function(){return this.wrapperReadySubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chartWrapper",{get:function(){return this.wrapper},set:function(t){this.wrapper=t,this.drawChart()},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.scriptLoaderService.loadChartPackages().subscribe((function(){t.createDataTable(),t.wrapper=new google.visualization.ChartWrapper({container:t.element.nativeElement,chartType:t.type,dataTable:t.dataTable,options:t.mergeOptions()}),t.registerChartEvents(),t.wrapperReadySubject.next(t.wrapper),t.initialized=!0,t.drawChart()}))},t.prototype.ngOnChanges=function(t){if(t.dynamicResize&&this.updateResizeListener(),this.initialized){var e=!1;(t.data||t.columns||t.formatters)&&(this.createDataTable(),this.wrapper.setDataTable(this.dataTable),e=!0),t.type&&(this.wrapper.setChartType(this.type),e=!0),(t.options||t.width||t.height||t.title)&&(this.wrapper.setOptions(this.mergeOptions()),e=!0),e&&this.drawChart()}},t.prototype.createDataTable=function(){if(null!=this.data){var t=!0;null!=this.columns&&(t=!1),this.dataTable=google.visualization.arrayToDataTable(this.getDataAsTable(),t),this.applyFormatters(this.dataTable)}},t.prototype.getDataAsTable=function(){return this.columns?h([this.columns],this.data):this.data},t.prototype.updateResizeListener=function(){var t=this;null!=this.resizeSubscription&&(this.resizeSubscription.unsubscribe(),this.resizeSubscription=null),this.dynamicResize&&(this.resizeSubscription=e.fromEvent(window,"resize").pipe(o.debounceTime(100)).subscribe((function(){t.initialized&&t.drawChart()})))},t.prototype.mergeOptions=function(){return n({title:this.title,width:this.width,height:this.height},this.options)},t.prototype.applyFormatters=function(t){var e,r;if(null!=this.formatters)try{for(var o=p(this.formatters),n=o.next();!n.done;n=o.next()){var a=n.value;a.formatter.format(t,a.colIndex)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},t.prototype.registerChartEvents=function(){var t=this;google.visualization.events.removeAllListeners(this.wrapper);var e=function(t,e,r){google.visualization.events.addListener(t,e,r)};e(this.wrapper,"ready",(function(){google.visualization.events.removeAllListeners(t.chart),e(t.chart,"onmouseover",(function(e){return t.mouseover.emit(e)})),e(t.chart,"onmouseout",(function(e){return t.mouseleave.emit(e)})),e(t.chart,"select",(function(){var e=t.chart.getSelection();t.select.emit({selection:e})})),t.ready.emit({chart:t.chart})})),e(this.wrapper,"error",(function(e){return t.error.emit(e)}))},t.prototype.drawChart=function(){null==this.dashboard&&this.wrapper.draw()},t.ctorParameters=function(){return[{type:r.ElementRef},{type:f},{type:C,decorators:[{type:r.Optional}]}]},a([r.Input(),s("design:type",String)],t.prototype,"type",void 0),a([r.Input(),s("design:type",Array)],t.prototype,"data",void 0),a([r.Input(),s("design:type",Array)],t.prototype,"columns",void 0),a([r.Input(),s("design:type",String)],t.prototype,"title",void 0),a([r.Input(),s("design:type",Number)],t.prototype,"width",void 0),a([r.Input(),s("design:type",Number)],t.prototype,"height",void 0),a([r.Input(),s("design:type",Object)],t.prototype,"options",void 0),a([r.Input(),s("design:type",Array)],t.prototype,"formatters",void 0),a([r.Input(),s("design:type",Object)],t.prototype,"dynamicResize",void 0),a([r.Output(),s("design:type",Object)],t.prototype,"ready",void 0),a([r.Output(),s("design:type",Object)],t.prototype,"error",void 0),a([r.Output(),s("design:type",Object)],t.prototype,"select",void 0),a([r.Output(),s("design:type",Object)],t.prototype,"mouseover",void 0),a([r.Output(),s("design:type",Object)],t.prototype,"mouseleave",void 0),t=a([r.Component({selector:"google-chart",template:"",host:{class:"google-chart"},exportAs:"googleChart",changeDetection:r.ChangeDetectionStrategy.OnPush,styles:[":host { width: fit-content; display: block; }"]}),i(2,r.Optional()),s("design:paramtypes",[r.ElementRef,f,C])],t)}(),O=function(){function t(t,o){this.element=t,this.scriptLoaderService=o,this.error=new r.EventEmitter,this.ready=new r.EventEmitter,this.select=new r.EventEmitter,this.wrapperReadySubject=new e.ReplaySubject(1),this.initialized=!1}return Object.defineProperty(t.prototype,"chart",{get:function(){return this.wrapper?this.wrapper.getChart():null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wrapperReady$",{get:function(){return this.wrapperReadySubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chartWrapper",{get:function(){return this.wrapper},set:function(t){this.wrapper=t,this.drawChart()},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.scriptLoaderService.loadChartPackages().subscribe((function(){t.specs||(t.specs={});var e=t.specs,r=(e.containerId,e.container,function(t,e){var r={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(t);n<o.length;n++)e.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(t,o[n])&&(r[o[n]]=t[o[n]])}return r}(e,["containerId","container"]));t.wrapper=new google.visualization.ChartWrapper(n(n({},r),{container:t.element.nativeElement})),t.registerChartEvents(),t.wrapperReadySubject.next(t.wrapper),t.drawChart(),t.initialized=!0}))},t.prototype.ngOnChanges=function(t){this.initialized&&t.specs&&(this.updateChart(),this.drawChart())},t.prototype.updateChart=function(){this.specs||(this.specs={}),this.wrapper.setChartType(this.specs.chartType),this.wrapper.setDataTable(this.specs.dataTable),this.wrapper.setDataSourceUrl(this.specs.dataSourceUrl),this.wrapper.setDataSourceUrl(this.specs.dataSourceUrl),this.wrapper.setQuery(this.specs.query),this.wrapper.setOptions(this.specs.options),this.wrapper.setRefreshInterval(this.specs.refreshInterval),this.wrapper.setView(this.specs.view)},t.prototype.drawChart=function(){this.wrapper.draw()},t.prototype.registerChartEvents=function(){var t=this;google.visualization.events.removeAllListeners(this.wrapper);var e=function(t,e,r){google.visualization.events.addListener(t,e,r)};e(this.wrapper,"ready",(function(){return t.ready.emit({chart:t.chart})})),e(this.wrapper,"error",(function(e){return t.error.emit(e)})),e(this.wrapper,"select",(function(){var e=t.chart.getSelection();t.select.emit({selection:e})}))},t.ctorParameters=function(){return[{type:r.ElementRef},{type:f}]},a([r.Input(),s("design:type",Object)],t.prototype,"specs",void 0),a([r.Output(),s("design:type",Object)],t.prototype,"error",void 0),a([r.Output(),s("design:type",Object)],t.prototype,"ready",void 0),a([r.Output(),s("design:type",Object)],t.prototype,"select",void 0),t=a([r.Component({selector:"chart-wrapper",template:"",host:{class:"chart-wrapper"},exportAs:"chartWrapper",changeDetection:r.ChangeDetectionStrategy.OnPush,styles:[":host { width: fit-content; display: block; }"]}),s("design:paramtypes",[r.ElementRef,f])],t)}(),S=((v={})[t.ChartType.AnnotationChart]="annotationchart",v[t.ChartType.AreaChart]="corechart",v[t.ChartType.Bar]="bar",v[t.ChartType.BarChart]="corechart",v[t.ChartType.BubbleChart]="corechart",v[t.ChartType.Calendar]="calendar",v[t.ChartType.CandlestickChart]="corechart",v[t.ChartType.ColumnChart]="corechart",v[t.ChartType.ComboChart]="corechart",v[t.ChartType.PieChart]="corechart",v[t.ChartType.Gantt]="gantt",v[t.ChartType.Gauge]="gauge",v[t.ChartType.GeoChart]="geochart",v[t.ChartType.Histogram]="corechart",v[t.ChartType.Line]="line",v[t.ChartType.LineChart]="corechart",v[t.ChartType.Map]="map",v[t.ChartType.OrgChart]="orgchart",v[t.ChartType.Sankey]="sankey",v[t.ChartType.Scatter]="scatter",v[t.ChartType.ScatterChart]="corechart",v[t.ChartType.SteppedAreaChart]="corechart",v[t.ChartType.Table]="table",v[t.ChartType.Timeline]="timeline",v[t.ChartType.TreeMap]="treemap",v[t.ChartType.WordTree]="wordtree",v);var j=function(){function t(){}var e;return e=t,t.forRoot=function(t){return void 0===t&&(t={}),{ngModule:e,providers:[{provide:y,useValue:t}]}},t=e=a([r.NgModule({declarations:[w,O,C,m,b],exports:[w,O,C,m,b]})],t)}();t.ChartEditorComponent=b,t.ChartEditorRef=d,t.ChartWrapperComponent=O,t.ControlWrapperComponent=m,t.DashboardComponent=C,t.GoogleChartComponent=w,t.GoogleChartsModule=j,t.ScriptLoaderService=f,t.getPackageForChart=function(t){return S[t]},t.ɵa=y,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-google-charts.umd.min.js.map